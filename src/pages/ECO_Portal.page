<apex:page applyBodyTag="false" controller="ECO_PortalController" showheader="false" sidebar="false" standardStylesheets="false" action="{!onLoad}" id="portalPage" title="{!$Label.Ecosystem}" >
    <title>{!$Label.Ecosystem}</title>

    <script>
        $(document).ready(function(){
            // Plugin used: http://jedfoster.com/Readmore.js, part of ECONiftyResources static resource
            $('div.nf').readmore({
			  speed: 75,
			  collapsedHeight: 40,
			  moreLink: '<a href="#">{!$Label.ECOPortalMore}</a>',
			  lessLink: '<a href="#">{!$Label.ECOPortalLess}</a>'
			});
			
			// Plugin used: http://tablesorter.com/docs, part of ECONiftyResources static resource
			$("#projectsTable").tablesorter();
        });

    </script>

    <style>

        @media screen and (max-width:768px){
            .hiddenOnMobile{
                opacity:0.8;
                display:none;
                background-color:#333 !important;
            }
            .showHideSwap{
                float: right;
                width: 132px;
                margin-top: -33px;
            }
        }
        .badge-header{
            margin-top: 8px !important;
            top:0 !important;
        }
        .publishercontainer .bottomBar{
            height:45px !important;
        }


 
    </style>

    <body class="nifty-ready">

    <apex:composition template="ECO_Temp_Portal" >
        
        <apex:define name="head">
            <script>var AWAN_online = false;</script>
            <script src="{!awanJSPath}"></script>
        </apex:define>

		<apex:define name="mainContent">
		<div id="content-container">

                <a class="aside-toggle hidden-xs" href="#" title="{!$Label.ECOPortalshowhideReports}"> 
                    <div class="reportsMenuButton" title="{!$Label.ECOPortalshowhideReports}">
                        <i class="fa fa-file" style="font-size:20px; color:#fff; margin:-5px 0 0 3px"></i><br />
                        <div class="menuText" style="bottom:7px;">Reports</div>
                    </div>
                </a>


                <apex:outputPanel layout="none" rendered="{!AND(tickerMessages != NULL, tickerMessages.size > 0)}" >
                    <div class="gallery autoplay items-{!tickerMessages.size}">
                        <apex:repeat value="{!tickerMessages}" var="message" >
	                        <apex:outputPanel layout="none" rendered="{!AND(message.NewsFeedTranslations__r != NULL, message.NewsFeedTranslations__r.size>0)}">
	                            <div id="item-{!message.Order__c}" class="control-operator"></div>
	                            <figure class="item">
	                            	<h4 id="tickerHeader">{!message.NewsFeedTranslations__r[0].Subject__c}</h4>
	                            	<apex:outputText value="{!message.NewsFeedTranslations__r[0].LongDescription__c}" />
	                            </figure>
	                        </apex:outputPanel>
                        </apex:repeat>

                        <div class="controls">
                            <apex:repeat value="{!tickerMessages}" var="message" >
                            	<apex:outputPanel layout="none" rendered="{!AND(message.NewsFeedTranslations__r != NULL, message.NewsFeedTranslations__r.size>0)}">
                                	<a href="#item-{!message.Order__c}" class="control-button">&bull;</a>
                                </apex:outputPanel>
                            </apex:repeat>
                        </div>
                    </div>
                </apex:outputPanel>

                
                <!--Page content-->
                <!--===================================================-->
                <div id="page-content">


                    
                    <div class="row">




                        <div class="col-lg-7">
                    
                            <div id="newsFeed" class="panel">
                                <div class="panel-heading">
                                    <div class="panel-control">
                                        
                                    </div>
                                    <a name="newsFeed" style="height:0;"></a>
                                    <h3 class="panel-title">{!$Label.ECOPortalNewsFeed}</h3>
                                </div>

                                <div class="panel-body collapse in nano"  style="max-height:372px; min-height:372px;">
                                    <div class="nano-content pad-all">
                                        <!-- REPEAT THIS -->
                                        <apex:repeat value="{!newsFeed}" var="feedItem" >
                                        	<apex:outputPanel layout="none" rendered="{!AND(feedItem.NewsFeedTranslations__r != NULL, feedItem.NewsFeedTranslations__r.size>0)}">
                                            <div class="row">
                                                <div class="col-sm-2">
                                                    <apex:image value="{!URLFOR($Resource.ECO_NiftyAssets, 'ECO_NiftyAssets/img/loader.gif')}" html-data-original="{!feedItem.FullImageUrl__c}" styleClass="media-object hidden-xs lazy" rendered="{!feedItem.FullImageUrl__c != ''}"/>
                                                    <apex:image value="{!URLFOR($Resource.ECO_NiftyAssets, 'ECO_NiftyAssets/img/loader.gif')}" html-data-original="{!$Resource.ECO_DELogo}" styleClass="media-object hidden-xs lazy" rendered="{!feedItem.FullImageUrl__c == ''}"/>
                                                </div>
                                                <div class="col-sm-10" style="line-height:165%;">
                                                	<apex:outputPanel layout="none" rendered="{!AND(feedItem.NewsFeedTranslations__r != NULL, feedItem.NewsFeedTranslations__r.size>0, feedItem.NewsFeedTranslations__r[0].LinkToRecord__c != '')}">
                                                        <a href="{!feedItem.NewsFeedTranslations__r[0].LinkToRecord__c}" class="linkFix hidden-xs" target="_newsFeedItem{!feedItem.Id}">
                                                            {!feedItem.NewsFeedTranslations__r[0].Subject__c}
                                                        </a>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="none" rendered="{!AND(feedItem.NewsFeedTranslations__r != NULL, feedItem.NewsFeedTranslations__r.size>0, feedItem.NewsFeedTranslations__r[0].LinkToRecord__c == '')}">
                                                        <h2 style="line-height:200%;">
                                                        	<apex:outputText value="{!feedItem.NewsFeedTranslations__r[0].Subject__c}" />
                                                    	</h2>
                                                    </apex:outputPanel>
                                                    <br />
													<div class="nf">
														<p>{!feedItem.NewsFeedTranslations__r[0].LongDescription__c}</p>
													</div>
													
													<br />
                                                    <span style="color:#c6c6c6; font-size:10px; margin-top:5px; display:block;">
                                                        <!-- Posted on Feb. 26th, 2015 | By: This Person -->
                                                        <apex:outputText value="{!$Label.ECOPortalPostedOn} {!feedItem.StartDate__c} | {!$Label.ECOPortalBy}:  {!feedItem.User__r.Name} "/>
                                                    </span>
                                                </div>
                                                <div class="col-sm-12">
                                                    <hr />
                                                </div>
                                            </div>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                        <!-- END REPEAT -->
                                    </div>
                                </div>
                            </div>
                        </div>




                        <div class="col-lg-5">

                    
                            <!--Chat Widget-->
                            <div class="panel hidden-xs">
                    
                                <!--Chat widget header-->
                                <div class="panel-heading">
                                    <a href="/home/home.jsp" target="_blank">
                                    <div class="panel-control">
                                        <div class="btn-group">
                                        <i class="fa fa-sign-in" style="float:right; font-size:16px; margin-right:6px;"></i>
                                        </div>
                                    </div>
                                    <a name="chatterFeed" style="height:0;"></a>
                                    <h3 class="panel-title">{!$Label.ECOPortalChatter}</h3>
                                    </a>
                                </div>
                    
                                <!--Chat widget body-->
                                <div class="panel-body collapse in nano" style="padding-top:5px; max-height:372px; min-height:372px;">
                                    <div class="nano-content pad-all">
                                        <!-- <chatter:feed entityId="{!$User.Id}" /> -->
                                        <chatter:newsFeed />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END FIRST ROW -->


<!--                     START SECOND ROW  -->
                    <div id="myProjectsPortfolio" class="row">
                        <div class="col-lg-12">
                    
                            <div class="panel">
                                <div class="panel-heading">
                                <!-- 
                                    <div class="panel-control hidden-xs">
                                        <apex:form id="selecterForm">
                                            <apex:actionFunction name="changeProjectOutputType" action="{!changeProjectOutputType}" />
                                            
                                             <apex:selectList value="{!selectedOutputType}" multiselect="false" onchange="changeProjectOutputType();" size="1" >
                                                <apex:selectOptions value="{!projectOutputTypes}"/>
                                             </apex:selectList>
                                            
                                             <apex:actionFunction name="apexRefreshProjects" action="{!refreshProjects}" />

                                             Show Closed&nbsp;<apex:inputCheckbox value="{!showClosed}" onchange="apexRefreshProjects();" />
                                            
                                             Show for Roles&nbsp;<apex:inputField value="{!ptmPickListProvider.Role__c}" onchange="apexRefreshProjects();" />
                                        </apex:form>
                                    </div>
                                    -->
                                    <a name="myProjects" style="height:0;"></a>
                                    <h3 class="panel-title">{!$Label.ECOPortalMyProjectsPortfolio}</h3>
                                </div>

   
								<div class="panel-body myProjectsPortfolio">
									<!-- 
                                    <div class="table-responsive hidden-xs" id="portfolioTable">
                                        <table id="projectsTable" class="table table-striped table-hover tablesorter">
                                            <thead>
                                                <tr>
                                                    <apex:repeat: value="{!fieldSetFields}" var="field" id="headerRepeater" >
                                                        <th>
                                                            {!field.Label}
                                                        </th>
                                                    </apex:repeat:>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <apex:repeat value="{!projects}" var="p">
                                                    <tr>
                                                        <apex:repeat: value="{!fieldSetFields}" var="fieldName" id="rowRepeater">
                                                            <td>
                                                                <apex:outputField value="{!p[fieldName]}" />
                                                            </td>
                                                        </apex:repeat:>
                                                    </tr>
                                                </apex:repeat>


                                            </tbody>
                                        </table>
                                    </div>
                                    -->
                                    <div class="tempAlert">
                                        {!$Label.ECOPortalMyProjectsPortfolioMessage}
                                    </div>

                                </div>
                               
                            </div>
                        </div>
                    </div> 
<!--                END 2nd Row (my projects table)    -->

           
                    <div class="row">
                    <a name="graphs" style="height:0;"></a>
            
                        <!-- CLIENT CARE PROGRAM -->
                        <div class="col-md-4">
                            <div class="panel panel-dark panel-colorful">
                                <div class="panel-body text-center">
                                    <p class="text-uppercase mar-btm text-sm">{!$Label.ECOPortalClientCareProgram}</p>
                                    <div id="client-care-program" class="box-inline "></div>
                                    <hr />
                                    <p class="h2 text-thin">{!$Label[clientCareNpsTextLabel]}</p>
                                </div>
                            </div>
                        </div>
            
            
                        <!-- SAFETY -->
                        <div class="col-md-4">
                            <div class="panel panel-danger panel-colorful">
                                <div class="panel-body text-center">
                                    <p class="text-uppercase mar-btm text-sm">{!$Label.ECOPortalTotalCaseIncidentRate}</p>
                                    <!-- Dynamic graph out <div id="demo-sparkline-bar" class="box-inline "></div> -->

                                    <!--Gauge placeholder-->
                                    <canvas id="case-incident-rate" height="120" class="canvas-responsive"></canvas>
            
                                    <p class="h4" style="display:none;">
                                        <span id="case-incident-rate-txt" class="label label-primary"></span>
                                    </p>
                                    <hr />

                                    <p class="h2 text-thin">{!$Label[incidentRateTextLabel]}</p>
                                </div>
                            </div>
                        </div>

                        <!-- TPN -->
                        <div class="col-md-4">
                            <div class="panel panel-primary panel-colorful">
                                <div class="panel-body text-center">
                                    <p class="text-uppercase mar-btm text-sm">{!$Label.ECOPortalTechincalPracticeNetworks}</p>
                                    <div id="technical-practice-networks" style="height:120px"></div>
                                    <hr />
                                    <p class="h2 text-thin">{!$Label.ECOPortalVisitorData}</p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-3">
                        </div>

                        <div class="col-sm-6" style="text-align:center;">
                            <div class="tempAlert">
                                {!$Label.ECOPortalAlertMessage}
                            </div>
                        </div>

                        <div class="col-sm-3">
                        </div>
                    </div>
            
                            
                </div>
                <!--===================================================-->
                <!--End page content-->

            </div>
            <!--===================================================-->
            <!--END CONTENT CONTAINER-->
		</apex:define>
		
		<apex:define name="rightNav">
		    <!--ASIDE: Edit Reports and list reports -->
            <!--===================================================-->
            <aside id="aside-container">
                <div id="aside">
                    <div class="nano has-scrollbar">
                        <div class="nano-content">
                            <div class="tab-pane fade in active" id="demo-asd-tab-1">
                                <div class="navbar-header">
                                    <a class="navbar-brand" style="cursor:default;">
                                        <div class="brand-title" style="text-align:center;">
                                            <span class="brand-text">{!$Label.ECORepFindSelectedReports}</span>
                                        </div>
                                    </a>
                                </div>

                            <!-- OLD TITLE OUT FOR NOW, 7/7/2015, ANDREW SMITH
                                <h4 class="pad-hor text-thin">
                                    <a style="margin:0 25px 0 5px; cursor:pointer; float:right;">Selected {!$Label.ECOPortalReports}</a>
                                </h4>
                            -->
                                
                                <div>
                                    <div class="list-group bg-trans">
                                        <div class="editReports editApps" style="float:left; display:block">
                                            <a style="cursor:pointer" onclick="goToReportsBuilder()" class="list-group-item">
                                                <div class="media-left">
                                                    <i class="fa fa-cog" style="font-size:22px; color:#adb3b8;" title="{!$Label.ECOPortalEditReports}"></i>
                                                </div>
                                                <div class="media-body menu-title">
                                                    Edit Reports
                                                </div>
                                            </a>
                                        </div>

                                        <apex:repeat value="{!reports}" var="report" >
                                            <div style="float:left; display:block">
                                                <apex:outputLink value="/{!report.ReportId__c}" styleClass="list-group-item" target="_Report-{!report.ReportId__c}">
                                                    <div class="media-left">
                                                        <i class="fa fa-file" style="font-size:20px; padding-top:5px;"></i>
                                                    </div>
                                                    <div class="media-body">
                                                        <apex:outputText value="{!report.ReportName__c}" />
                                                    </div>
                                                </apex:outputLink>
                                            </div>
                                        </apex:repeat>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>
            </aside>
            <!--===================================================-->
            <!--END ASIDE-->
		</apex:define>
    </apex:composition>
</body>
</apex:page>